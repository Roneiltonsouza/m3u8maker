<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>POST foto | Cloud Storage</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        body {
            background: linear-gradient(135deg, #8a131a 0%, #000000 100%);
            min-height: 100vh;
            color: white;
            overflow-x: hidden;
        }
        .glass-card {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(15px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        .hidden-app { display: none !important; }
        
        .modal-fade {
            transition: all 0.3s ease-in-out;
            transform: translateY(20px);
            opacity: 0;
        }
        .modal-active .modal-fade {
            transform: translateY(0);
            opacity: 1;
        }
        /* Estilo para o visualizador de imagem cheia */
        #viewerOverlay {
            background: rgba(0,0,0,0.95);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 200;
        }
    </style>
</head>
<body class="font-sans">

    <div id="viewerOverlay" class="fixed inset-0 p-4">
        <button onclick="closeViewer()" class="absolute top-6 right-6 text-white text-3xl hover:text-red-500 transition">
            <i class="fas fa-times"></i>
        </button>
        <img id="fullImage" src="" class="max-w-full max-h-full rounded-lg shadow-2xl object-contain">
    </div>

    <div id="welcomeScreen" class="fixed inset-0 z-[100] flex flex-col items-center justify-center p-6 bg-black/80">
        <div class="text-center mb-12">
            <h1 class="text-6xl font-black tracking-tighter italic text-white mb-2">
                POST <span class="text-red-600 font-light">foto</span>
            </h1>
            <p class="text-gray-400">Sua nuvem privada, simples e segura.</p>
        </div>
        
        <div class="flex flex-col gap-4 w-full max-w-xs">
            <button onclick="openModal('register')" class="bg-red-600 hover:bg-red-700 p-4 rounded-2xl font-bold transition shadow-lg">CRIAR NOVA CONTA</button>
            <button onclick="openModal('login')" class="bg-white/10 hover:bg-white/20 border border-white/20 p-4 rounded-2xl font-bold transition">ACESSAR MINHA NUVEM</button>
        </div>
    </div>

    <div id="authModal" class="fixed inset-0 z-[110] hidden flex items-center justify-center p-6 bg-black/60 backdrop-blur-sm">
        <div class="modal-fade glass-card w-full max-w-md p-8 rounded-3xl relative">
            <button onclick="closeModal()" class="absolute top-4 right-4 text-gray-400 hover:text-white">
                <i class="fas fa-times text-xl"></i>
            </button>
            <div id="modalContent"></div>
        </div>
    </div>

    <div id="appContent" class="hidden-app">
        <header class="p-6 flex justify-between items-center sticky top-0 z-50 glass-card">
            <h1 class="text-2xl font-bold tracking-tighter italic">POST <span class="font-light text-red-500">foto</span></h1>
            
            <div class="flex items-center gap-4">
                <div class="flex flex-col items-end">
                    <span id="userDisplay" onclick="logout()" class="text-sm font-bold text-white opacity-80 hover:opacity-100 hover:text-red-400 cursor-pointer transition underline decoration-dotted uppercase tracking-wider">SAIR</span>
                    <button onclick="deleteAccount()" class="text-[9px] font-bold text-red-500 mt-1 uppercase tracking-widest hover:text-white transition">Excluir Conta</button>
                </div>
                <div class="w-10 h-10 rounded-full bg-red-600 flex items-center justify-center border-2 border-white/50">
                    <i class="fas fa-user text-sm"></i>
                </div>
            </div>
        </header>

        <main class="max-w-4xl mx-auto p-4">
            <section class="glass-card rounded-3xl p-8 mb-8 text-center border-dashed border-2 border-red-500/50 mt-6">
                <input type="file" id="fileInput" class="hidden" accept="image/*" multiple>
                <label for="fileInput" class="cursor-pointer group block">
                    <div class="mb-4 text-6xl text-red-500 group-hover:scale-110 transition-transform duration-300">
                        <i class="fas fa-cloud-upload-alt"></i>
                    </div>
                    <h2 class="text-xl font-bold">Postar Fotos na Nuvem</h2>
                    <p class="text-sm opacity-60">Selecione imagens para salvar</p>
                </label>
                
                <div id="progressContainer" class="hidden mt-6">
                    <div class="w-full bg-gray-700 rounded-full h-2">
                        <div id="progressBar" class="bg-red-500 h-2 rounded-full transition-all duration-500" style="width: 0%"></div>
                    </div>
                </div>
            </section>

            <div id="photoGrid" class="grid grid-cols-2 md:grid-cols-3 gap-4 pb-20"></div>
        </main>
    </div>

    <script>
        const modal = document.getElementById('authModal');
        const modalContent = document.getElementById('modalContent');
        const welcomeScreen = document.getElementById('welcomeScreen');
        const appContent = document.getElementById('appContent');
        const viewerOverlay = document.getElementById('viewerOverlay');
        const fullImage = document.getElementById('fullImage');

        function openModal(type) {
            modal.classList.remove('hidden');
            setTimeout(() => modal.classList.add('modal-active'), 10);
            if (type === 'register') {
                modalContent.innerHTML = `<h2 class="text-2xl font-bold mb-6 text-center">Criar Conta</h2><input type="email" id="email" placeholder="Seu e-mail" class="w-full p-4 mb-4 rounded-xl bg-white/10 border border-white/20 outline-none focus:border-red-500 text-white"><input type="password" id="pin" maxlength="4" placeholder="PIN de 4 dígitos" class="w-full p-4 mb-6 rounded-xl bg-white/10 border border-white/20 outline-none focus:border-red-500 text-center text-xl tracking-widest text-white"><button onclick="handleAuth('register')" class="w-full bg-red-600 hover:bg-red-700 p-4 rounded-xl font-bold transition">CADASTRAR</button>`;
            } else {
                modalContent.innerHTML = `<h2 class="text-2xl font-bold mb-6 text-center">Login</h2><input type="email" id="email" placeholder="E-mail" class="w-full p-4 mb-4 rounded-xl bg-white/10 border border-white/20 outline-none focus:border-red-500 text-white"><input type="password" id="pin" maxlength="4" placeholder="PIN" class="w-full p-4 mb-6 rounded-xl bg-white/10 border border-white/20 outline-none focus:border-red-500 text-center text-xl text-white"><button onclick="handleAuth('login')" class="w-full bg-white text-black p-4 rounded-xl font-bold hover:bg-gray-200 transition">ENTRAR</button>`;
            }
        }

        function closeModal() {
            modal.classList.remove('modal-active');
            setTimeout(() => modal.classList.add('hidden'), 300);
        }

        function handleAuth(mode) {
            const email = document.getElementById('email').value.toLowerCase();
            const pin = document.getElementById('pin').value;
            if (!email.includes('@') || pin.length < 4) { alert("E-mail inválido ou PIN curto demais."); return; }
            if (mode === 'register') {
                if (localStorage.getItem(email)) { alert("E-mail já cadastrado."); } 
                else { localStorage.setItem(email, pin); loginUser(email); }
            } else {
                if (localStorage.getItem(email) === pin) { loginUser(email); } 
                else { alert("Dados incorretos."); }
            }
        }

        function loginUser(email) {
            localStorage.setItem('currentUser', email);
            welcomeScreen.classList.add('hidden');
            closeModal();
            appContent.classList.remove('hidden-app');
        }

        function logout() {
            if(confirm("Deseja sair da sua conta?")) {
                localStorage.removeItem('currentUser');
                location.reload();
            }
        }

        function deleteAccount() {
            const email = localStorage.getItem('currentUser');
            if (confirm(`Atenção: Deseja APAGAR a conta e todos os dados?`)) {
                localStorage.removeItem(email);
                localStorage.removeItem('currentUser');
                location.reload();
            }
        }

        // VISUALIZAÇÃO E EXCLUSÃO
        function viewImage(src) {
            fullImage.src = src;
            viewerOverlay.style.display = 'flex';
        }

        function closeViewer() {
            viewerOverlay.style.display = 'none';
        }

        function deletePhoto(button) {
            if(confirm("Excluir esta foto permanentemente?")) {
                button.parentElement.remove();
            }
        }

        // LOGICA DE UPLOAD
        const fileInput = document.getElementById('fileInput');
        const photoGrid = document.getElementById('photoGrid');

        fileInput.addEventListener('change', function(e) {
            const files = e.target.files;
            if (files.length > 0) {
                document.getElementById('progressContainer').classList.remove('hidden');
                let progress = 0;
                const interval = setInterval(() => {
                    progress += 25;
                    document.getElementById('progressBar').style.width = progress + '%';
                    if(progress >= 100) {
                        clearInterval(interval);
                        document.getElementById('progressContainer').classList.add('hidden');
                        renderPhotos(files);
                        document.getElementById('progressBar').style.width = '0%';
                    }
                }, 150);
            }
        });

        function renderPhotos(files) {
            Array.from(files).forEach(file => {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const div = document.createElement('div');
                    div.className = "relative group rounded-2xl aspect-square overflow-hidden shadow-xl border border-white/10 bg-black";
                    
                    div.innerHTML = `
                        <img src="${e.target.result}" onclick="viewImage('${e.target.result}')" class="w-full h-full object-cover cursor-zoom-in group-hover:scale-105 transition duration-500">
                        <button onclick="deletePhoto(this)" class="absolute top-2 right-2 bg-black/60 text-white w-8 h-8 rounded-full opacity-0 group-hover:opacity-100 transition-opacity hover:bg-red-600">
                            <i class="fas fa-trash-alt text-xs"></i>
                        </button>
                        <div class="absolute bottom-2 left-2 pointer-events-none opacity-0 group-hover:opacity-100 transition-opacity">
                             <i class="fas fa-arrow-up-right-from-square text-xs bg-black/40 p-2 rounded-lg"></i>
                        </div>
                    `;
                    photoGrid.prepend(div);
                }
                reader.readAsDataURL(file);
            });
        }

        window.onload = () => {
            const user = localStorage.getItem('currentUser');
            if(user) loginUser(user);
        }
    </script>
</body>
</html>
